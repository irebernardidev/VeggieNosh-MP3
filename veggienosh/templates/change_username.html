{% extends 'base.html' %}

{% block content %}

    <!-- Start of Username Change Section -->
    <section class="login-reg-section center-align">
        
        <!-- VeggieNosh Logo for Login Section -->
        <a href="{{ url_for('home') }}">
            <img
                src="{{ url_for('static', filename='images/logo.png') }}"
                class="logo-login-register hide-on-med-and-down"
                alt="VeggieNosh Logo"
                lazyload="on"
            />
        </a>
        
        <!-- Heading for Username Change -->
        <h1 class="secondary-heading heading-black uppercase">Sprout a New Username!</h1>
        
        <!-- Form for Username Change -->
        <div class="row">
            <form method="POST" action="" autocomplete="off" class="col s12">
                
                {{ form.hidden_tag() }}
                
                <div class="row">
                    <!-- Displaying Current Username -->
                    <div class="input-field col s12">
                        <i class="fas fa-user prefix"></i>
                        <input
                            value="{{username}}"
                            id="current_username"
                            name="current_username"
                            type="text"
                            disabled
                        />
                        <label for="current_username">Current Veggie Name</label>
                    </div>
                </div>
                
                <div class="row">
                    <!-- Input Field for New Username -->
                    <div class="input-field col s12">
                        <i class="fas fa-user-edit prefix"></i>
                        {{ form.new_username.label }} 
                        {{ form.new_username(placeholder="Sprout a new name") }} 
                        {% for error in form.new_username.errors %}
                            <span class="error-message">{{ error }}</span>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Displaying Error Messages -->
                <div class="row center-align">
                    {% with messages = get_flashed_messages() %}
                        {% if messages %} 
                            {% for message in messages %}
                                <p class="error-message">
                                    {{ message }}
                                </p>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
                </div>
                
                <!-- Cancel and Submit Buttons -->
                <div class="col s6 right-align buttons-change">
                    <a
                        href="{{ url_for('account_settings', username=session.username) }}"
                        class="btn z-depth-2 btn-form btn-secondary waves-effect waves-light uppercase"
                        name="action"
                    >
                        Retreat!
                    </a>
                </div>
                <div class="col s6 left-align buttons-change">
                    {{ form.submit(class="btn z-depth-3 btn-login button-coral uppercase") }}
                </div>

            </form>
        </div>
    </section>
    <!-- End of Username Change Section -->

{% endblock %}
